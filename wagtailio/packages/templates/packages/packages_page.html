{% extends "patterns/base_page.html" %}

{% load wagtailcore_tags wagtailimages_tags %}

{% block content %}

    {# BE: hero component should be used here #}
    <div class="grid">
        <div class="hero {% if classes %}{{ classes }}{% endif %}">
            <div class="hero__inner">
                <h1 class="hero__heading">{{ page.title }}</h1>

                {% if page.subtitle %}
                    <h2 class="hero__subheading intro-big">{{ page.subtitle }}</h2>
                {% endif %}

                {% include "patterns/components/buttons/button.html" with arrow=False url="#about" title=page.about_title classes="hero__button" %}
            </div>

            {% include "patterns/components/icon/icon.html" with icon=heart classes="hero__icon" %}
        </div>
    </div>

    <div class="features feature--packages" id="additional">

        <div class="grid features__container page-content">
            <div class="container packages__jumplinks">
                {% for grid in grids %}
                    <a href="#{{ grid.slug }}">{{ grid.display_title }}</a>{% if forloop.last %}.{% else %}, {% endif %}
                {% endfor %}
            </div>
        </div>

        <div class="grid features__container">
            <h2 class="features__heading">{{ value.title }}</h2>
            {% for grid in grids %}
                <div class="features__section" id="{{ grid.slug }}">

                    <div class="packages__sub-heading">
                        <h3 class="features__sub-heading">
                            <a href="{{ grid.get_absolute_url }}">{{ grid.display_title }}</a>
                            {% if perms.packages.change_grid %}
                                <a href="{{ grid.get_admin_url }}">✏️</a>
                            {% endif %}
                        </h3>
                        <p>
                            {{ grid.description }}<br>
                            <a class="packages__xs" href="{{ grid.get_absolute_url }}">Full grid on Djangopackages.org</a>
                        </p>
                    </div>

                    <div class="features__content">

                        {% for package in grid.packages.all %}

                            <article class="feature-item">
                                <h4 class="feature-item__heading">
                                    <a href="{{ package.get_absolute_url }}">
                                        {{ package.title }}
                                        {% if perms.packages.change_package %}
                                            <a href="{{ package.get_admin_url }}">✏️</a>
                                        {% endif %}
                                    </a>
                                </h4>
                                <div class="feature-item__description">
                                    {% if package.repo_description %}
                                        {{ package.repo_description }}<br>
                                    {% endif %}
                                    {% for url, label in package.links %}
                                        <a href="{{ url }}">{{ label }}</a>
                                        {% if not forloop.last %}–{% endif %}
                                    {% endfor %}
                                </div>
                            </article>

                        {% endfor %}

                    </div>

                </div>
            {% endfor %}
        </div>

        {# BE: Should also use the hero include #}
        <div class="grid" id="about">
            <div class="hero">
                <div class="hero__inner">
                    <h2 class="hero__heading">{{ page.about_title }}</h2>

                    {% if page.about_text %}
                        <div class="hero__intro">{{ page.about_text|richtext }}</div>
                    {% endif %}
                </div>
            </div>
        </div>

    </div>

{% endblock %}
